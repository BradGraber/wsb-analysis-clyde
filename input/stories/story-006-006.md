---
id: story-006-006
epic: epic-006
title: Implement Options Premium Monitoring Exits
priority: high
story_points: [TBD]
source_requirements: [FR-041, FR-042, FR-043, FR-048, PIPE-045]
dependencies: [story-006-005, story-006-009, story-006-010]
blocks: []
---

# Story: Implement Options Premium Monitoring Exits

## Description
Implement three premium-based exit conditions for options positions: stop-loss at -50% premium loss from entry, take-profit at +100% premium gain (exit 50% contracts, activate trailing stop), and trailing stop at -30% drop from peak_premium. These conditions are checked in priority order after expiration protection.

## Acceptance Criteria
- [ ] Premium stop-loss triggers when current_premium <= entry_premium * 0.50 (exit 100%, exit_reason='stop_loss')
- [ ] Premium take-profit triggers when premium_change_pct >= +100% (current_premium >= entry_premium * 2.0), exiting 50% of contracts_remaining
- [ ] After premium take-profit, trailing_stop_active is set to TRUE on the position
- [ ] Premium trailing stop triggers when current_premium <= peak_premium * 0.70 (-30% from peak), exiting all remaining contracts
- [ ] Priority order is respected: stop-loss > take-profit > trailing (per PIPE-045, after expiration)
- [ ] Exit prices for premium exits are set to current_premium at time of trigger
- [ ] Exit reasons are correctly set: 'stop_loss', 'take_profit', 'trailing_stop'

## Technical Notes
- FR-041: Premium stop-loss at -50% from entry_premium.
- FR-042: Premium take-profit at +100%, exit 50% contracts, apply trailing stop.
- FR-043: Trailing stop at -30% from peak_premium (peak_premium * 0.70).
- FR-048: Options position monitoring checks all open positions in priority order.
- PIPE-045: Options priority cascade after expiration: stop-loss > take-profit > trailing > time.
- premium_change_pct = (current_premium - entry_premium) / entry_premium * 100.
- Partial exit mechanics (quantity calculation, position_exits INSERT) handled by story-006-009.
- Peak premium tracking handled by story-006-010.

## Dependencies
- Depends on: story-006-005 (expiration protection must be checked first), story-006-009 (partial exit mechanics), story-006-010 (peak premium tracking)
- Blocks: none
