---
id: story-009-001
epic: epic-009
title: Implement Author Trust Score Calculation
priority: high
story_points: [TBD]
source_requirements: [TRUST-SCORE, TRUST-QUALITY, TRUST-ACCURACY, TRUST-TENURE, TRUST-COLD-START, CFG-TRUST-WEIGHTS]
dependencies: [epic-001]
blocks: [story-009-002]
---

# Story: Implement Author Trust Score Calculation

## Description
Implement the 3-component trust score formula: trust_score = (quality_ratio * weight_quality) + (accuracy_component * weight_accuracy) + (tenure_factor * weight_tenure). Quality ratio is high_quality_comments / max(total_comments, 1). Accuracy component uses avg_sentiment_accuracy if not NULL, else the configurable default (0.5). Tenure factor is min(1.0, days_active / tenure_saturation_days). All weights and defaults are read from system_config at runtime (trust_weight_quality, trust_weight_accuracy, trust_weight_tenure, trust_default_accuracy, trust_tenure_saturation_days).

## Acceptance Criteria
- [ ] A `calculate_trust_score(author)` function exists that accepts an author record and returns a float in range [0.0, 1.0], rounded to 3 decimal places
- [ ] Quality ratio is computed as `high_quality_comments / max(total_comments, 1)` using author table fields
- [ ] Accuracy component uses `avg_sentiment_accuracy` when not NULL, and falls back to the `trust_default_accuracy` config value (default 0.50) for authors with NULL accuracy
- [ ] Tenure factor is computed as `min(1.0, days_since_first_seen / trust_tenure_saturation_days)` where `trust_tenure_saturation_days` is read from system_config (default 30)
- [ ] All three weights (trust_weight_quality, trust_weight_accuracy, trust_weight_tenure) are read from system_config, not hardcoded
- [ ] Cold start behavior verified: a brand-new author (0 comments, NULL accuracy, first_seen=today) returns exactly `trust_default_accuracy * trust_weight_accuracy` (i.e., 0.25 with defaults)
- [ ] Unit tests cover: new author (cold start), established author (all components populated), author with NULL accuracy but high quality ratio, author with tenure > saturation days (capped at 1.0)

## Technical Notes
- Full algorithm specified in PRD Appendix F.2 (lines 2899-2968) with pseudocode in F.2.4
- Implementation note in PRD: weights MUST be read from system_config, not hardcoded (line 2941)
- The 6 config keys are: trust_weight_quality (0.40), trust_weight_accuracy (0.50), trust_weight_tenure (0.10), trust_default_accuracy (0.50), trust_tenure_saturation_days (30), accuracy_ema_weight (0.30)
- This function is called in Phase 2 (comment prioritization), Phase 3 (AI prompt context), and Phase 4 (signal confidence) -- it must be a shared utility
- Depends on epic-001 providing the authors table schema and system_config entries

## Dependencies
- Depends on: epic-001 (database schema with authors table and system_config entries for trust weights)
- Blocks: story-009-002 (author metrics update calls trust score after updating counters)
