---
id: story-008-011
epic: epic-008
title: Implement Dashboard Token Expiration Banner
priority: medium
story_points: [TBD]
source_requirements: [INT-SCHWAB-REFRESH]
dependencies: [story-008-001, story-006-014]
blocks: []
---

# Story: Implement Dashboard Token Expiration Banner

## Description
Implement a persistent warning banner on the dashboard that appears when the Schwab OAuth token is approaching expiration (within 24 hours). The banner polls GET /auth/status (implemented in epic-006 story-006-014) to check token health. The banner is dismissible but re-appears on the next poll cycle if the token is still near expiration.

## Acceptance Criteria
- [ ] Dashboard polls GET /auth/status periodically (every 5 minutes) to check Schwab token expiration status
- [ ] When token expires within 24 hours, a persistent warning banner is displayed at the top of the dashboard
- [ ] Banner message includes the approximate time until expiration (e.g., "Schwab token expires in approximately 6 hours. Please re-authenticate.")
- [ ] Banner is dismissible via a close button
- [ ] After dismissal, banner re-appears on the next poll cycle if the token is still within 24 hours of expiration
- [ ] When token is healthy (>24 hours until expiration), no banner is shown
- [ ] If GET /auth/status endpoint returns an error or is unreachable, the banner is not shown (fail silently)

## Technical Notes
- GET /auth/status is implemented in story-006-014 (Token Health Check Endpoint)
- Poll interval: 5 minutes (300 seconds) is sufficient since token expiration changes slowly
- Banner component: `<TokenExpirationBanner />` rendered in the app layout above main content
- Use a ref to track dismissed state; reset dismissed flag when a new poll detects expiration
- The auth/status endpoint returns token_expires_at timestamp; compute hours remaining client-side
- Fail silently: if the endpoint 404s (epic-006 not yet deployed) or network errors, skip banner display
- This is a non-blocking enhancement; the application is fully functional without it

## Dependencies
- Depends on: story-008-001 (Vue scaffold for banner placement), story-006-014 (GET /auth/status endpoint)
- Blocks: none
