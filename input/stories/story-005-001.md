---
id: story-005-001
epic: epic-005
title: Implement Market Hours Check
priority: high
story_points: [TBD]
source_requirements: [PIPE-031]
dependencies: [epic-004]
blocks: [story-005-002]
---

# Story: Implement Market Hours Check

## Description
Implement the market hours gate that checks whether the current time falls within US equity market hours (9:30 AM - 4:00 PM Eastern Time). If outside market hours, skip all position opens entirely, log a warning with the market_hours_skipped indicator, and allow the pipeline to continue. Signals are still detected and recorded regardless of market hours.

## Acceptance Criteria
- [ ] Current time is evaluated in Eastern Time using pytz for timezone handling (handles EST/EDT transitions)
- [ ] Position opens are skipped entirely when current time is before 9:30 AM ET or after 4:00 PM ET
- [ ] Warning is logged when position opens are skipped: "Signal detected outside market hours; position not opened. Re-run during market hours to act on signals."
- [ ] Signals continue to be recorded in the signals table regardless of market hours (signal detection is not gated)
- [ ] Function returns a boolean indicating whether market hours are active, consumable by downstream position opening logic
- [ ] Weekend days (Saturday, Sunday) are treated as outside market hours

## Technical Notes
- PIPE-031: Market hours check using ET timezone, skip position opens if outside 9:30-16:00
- Use pytz.timezone('US/Eastern') for proper DST handling (EST = UTC-5, EDT = UTC-4)
- This is a simple gate at the top of Phase 5 pipeline logic -- if outside hours, return early from position management
- Consider also checking for US market holidays (stretch goal; not required for Phase 1, but worth a comment placeholder)
- The log message should include the current ET time for debugging

## Dependencies
- Depends on: epic-004 (qualified signals must exist before position management runs)
- Blocks: story-005-002 (qualified signal filtering)
