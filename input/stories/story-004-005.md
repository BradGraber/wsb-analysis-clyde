---
id: story-004-005
epic: epic-004
title: Implement Emergence Detection
priority: high
story_points: [TBD]
source_requirements: [FR-019, FR-020, FR-032, FR-033, PIPE-028]
dependencies: [story-004-001]
blocks: []
---

# Story: Implement Emergence Detection

## Description
Implement emergence detection that queries the prior 7 days of signal history per ticker and flags emergence when a previously cold ticker (fewer than 3 mentions in 7 days) suddenly gains traction (>= 13 current mentions from >= 8 distinct users). During the warmup period (days 1-7), is_emergence is set to NULL. In Phase 1, emergence is metadata only with no effect on position sizing.

## Acceptance Criteria
- [ ] Prior 7 days of mention history is queried per ticker from signals/comment_tickers tables
- [ ] Emergence fires when prior_mentions < 3 AND current_mentions >= 13 AND current_distinct_users >= 8
- [ ] During warmup period (system has fewer than 7 days of history), is_emergence is set to NULL (not false)
- [ ] After warmup (day 8+), is_emergence is set to true when criteria met, false when not met
- [ ] Emergence flag has no effect on position sizing or signal confidence in Phase 1 (metadata only)
- [ ] Emergence detection runs for every ticker in the current aggregation, not just those with fired signals
- [ ] Emergence flag is stored on the signal record. Tickers with emergence detected but no fired signal have emergence data logged at INFO level but not persisted to the database.

## Technical Notes
- PIPE-028: Emergence detection queries prior 7 days of data per ticker
- FR-032: Days 1-7 warmup produces NULL, not false, to distinguish "unknown" from "not emerging"
- FR-033: No position sizing impact in Phase 1; the flag is stored for future use and dashboard display
- "Prior 7 days" means the 7 calendar days before the current signal_date
- The mention count comes from comment_tickers entries linked to comments in the prior 7 days' analysis runs
- Distinct users comes from counting unique author_ids among those comments
- Consider computing emergence independently of signal firing -- a ticker can be "emerging" without qualifying as a Quality or Consensus signal

## Dependencies
- Depends on: story-004-001 (comment aggregation for current data, plus historical query)
- Blocks: none (emergence is metadata-only in Phase 1)
