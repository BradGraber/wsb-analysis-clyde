---
id: story-005-002
epic: epic-005
title: Implement Qualified Signal Filtering
priority: high
story_points: [TBD]
source_requirements: [PIPE-032]
dependencies: [story-005-001]
blocks: [story-005-003]
---

# Story: Implement Qualified Signal Filtering

## Description
Query the signals table to identify signals that are eligible for position opening: confidence >= 0.5 AND position_opened = false. Return the list of qualified signals for downstream processing by position sizing and opening logic.

## Acceptance Criteria
- [ ] Query filters signals WHERE confidence >= 0.5 AND position_opened = false
- [ ] Confidence threshold (0.5) is read from system_config key `signal_min_confidence` (seeded in story-001-002), not hardcoded
- [ ] Returned signals include all fields needed for downstream processing: ticker, signal_type, direction, confidence, signal_date
- [ ] Signals with position_opened = true are excluded (already acted upon)
- [ ] Signals with confidence < 0.5 are excluded (below threshold)
- [ ] Function returns an empty list (not an error) when no signals qualify

## Technical Notes
- PIPE-032: Identify qualified signals using confidence threshold and position_opened flag
- This is a simple SELECT query but is the entry point to the position management pipeline
- The confidence threshold comes from system_config key `signal_min_confidence` (default 0.5, seeded as the 34th config entry in story-001-002)
- Results should be ordered in a deterministic way (e.g., by confidence DESC) so highest-confidence signals are processed first
- Consider returning Signal model objects rather than raw rows for type safety

## Dependencies
- Depends on: story-005-001 (market hours check must pass before signals are filtered)
- Blocks: story-005-003 (position sizing needs qualified signals)
