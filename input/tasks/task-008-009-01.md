---
id: task-008-009-01
story: story-008-009
title: Build 4-stage progress indicator with polling and stage mapping
complexity: 2
---

# Task: Build 4-stage progress indicator with polling and stage mapping

## Description
Create a persistent `<ProgressIndicator>` component in the header area showing 4 pipeline stages: Fetching Reddit, Analyzing Comments (N/total), Detecting Signals, Monitoring Prices. The current stage is highlighted with a spinner, completed stages show checkmarks, upcoming stages are dimmed. Polls GET /runs/{id}/status every 10 seconds while status='running'. Map pipeline phases to stages: Phase 1+2 -> Fetching Reddit, Phase 3+3.5 -> Analyzing Comments, Phase 4 -> Detecting Signals, Phase 5+6 -> Monitoring Prices. Clean up interval on unmount or completion.

## Acceptance Criteria
- [ ] 4 stages displayed in order with labels
- [ ] Current stage: bold/colored with spinner; completed: checkmark; upcoming: dimmed
- [ ] "Analyzing comments" shows progress counter (progress_current / progress_total)
- [ ] Polls GET /runs/{id}/status every 10 seconds while status='running'
- [ ] On status='failed', error message displayed prominently
- [ ] Polling stops on completion or failure; interval cleaned up on unmount
- [ ] Stage mapping: Phase 1+2 -> Stage 1, Phase 3+3.5 -> Stage 2, Phase 4 -> Stage 3, Phase 5+6 -> Stage 4

## Technical Notes
- Persistent component in header/top area, visible across all tabs
- Use `setInterval` for polling with `clearInterval` in `onUnmounted`
- Consider integrating with `useAnalysis()` composable for state management
- current_phase and progress_current/progress_total from API response
- Component should be hidden when no active run exists

## Dependencies
- Depends on: task-008-001-01 (Vue scaffold for header placement)
- Blocks: task-008-009-02, task-008-010-01
