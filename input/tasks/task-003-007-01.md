---
id: task-003-007-01
story: story-003-007
title: Persist author trust snapshot from Phase 2 to comments table
complexity: 1
---

# Task: Persist author trust snapshot from Phase 2 to comments table

## Description
During AI analysis, ensure the author_trust_score already set on the ProcessedComment by Phase 2 (story-002-005) is persisted to the comments table as part of the batch INSERT/UPDATE. This is NOT a re-lookup from the authors table; Phase 2 already did the single lookup. This task ensures the value flows through the Phase 3 commit path (story-003-008) into the database.

## Acceptance Criteria
- [ ] The author_trust_score from ProcessedComment is included in the comments table INSERT/UPDATE during Phase 3 batch commit
- [ ] No additional SELECT from the authors table occurs in Phase 3 (eliminates the duplication identified in QA review)
- [ ] Deduplicated comments retain their original author_trust_score (not overwritten on dedup path)
- [ ] The stored value is a point-in-time snapshot: subsequent changes to authors.trust_score do not affect it
- [ ] Unit test: verify author_trust_score appears in the INSERT statement for new comments

## Technical Notes
- This is a data-flow verification task: ensure the field is included in the SQL statement within the batch commit
- The trust snapshot is used downstream by Phase 4 signal confidence calculation (CFG-CONFIDENCE-WEIGHTS author_trust 0.20)
- PRD reference: PIPE-019, Section 3.2.2 Phase 3 step 2 bullet 4

## Dependencies
- Depends on: task-003-008-01 (batch commit includes this field)
- Blocks: none
