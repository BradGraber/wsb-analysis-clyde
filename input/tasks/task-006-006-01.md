---
id: task-006-006-01
story: story-006-006
title: Implement options premium stop-loss exit condition
complexity: 2
---

# Task: Implement options premium stop-loss exit condition

## Description
Implement the options premium stop-loss exit condition function. When current_premium drops to or below 50% of entry_premium (i.e., current_premium <= entry_premium * 0.50), trigger a full close (100% of contracts_remaining) with exit_reason='stop_loss'. This is the second-priority options exit after expiration protection.

## Acceptance Criteria
- [ ] Triggers when current_premium <= entry_premium * 0.50 (-50% premium loss)
- [ ] Exits 100% of contracts_remaining (full close)
- [ ] Exit reason is 'stop_loss'
- [ ] Exit price is current_premium at time of trigger
- [ ] Only evaluated after expiration check passes (PIPE-045 priority)
- [ ] Function accepts MonitoredInstrument (not concrete Position type)

## Technical Notes
- FR-041: Premium-based stop-loss at -50% from entry_premium
- PIPE-045: Stop-loss is second priority after expiration in options cascade
- premium_change_pct = (current_premium - entry_premium) / entry_premium * 100
- Full close invokes finalization (story-006-011)

## Dependencies
- Depends on: task-006-005-01 (expiration must be checked first)
- Blocks: none
