---
id: task-006-015-01
story: story-006-015
title: Define MonitoredInstrument Protocol with runtime_checkable
complexity: 3
---

# Task: Define MonitoredInstrument Protocol with runtime_checkable

## Description
Define the MonitoredInstrument Python Protocol (typing.Protocol) with @runtime_checkable decorator. The protocol unifies position and prediction interfaces for exit evaluation: instrument_type ('stock'/'option'), entry_price, current_price, peak_price, remaining_quantity, open_date, trailing_stop_active, is_real_position (boolean discriminator), and for options: expiration_date and computed dte property. Write docstrings for each property. Include a unit test verifying both Position and Prediction models pass isinstance checks.

## Acceptance Criteria
- [ ] Protocol defined with @runtime_checkable decorator using typing.Protocol
- [ ] Unified property names: instrument_type, entry_price, current_price, peak_price, remaining_quantity, open_date, trailing_stop_active
- [ ] is_real_position boolean property for discriminating positions from predictions
- [ ] Options instruments expose expiration_date and computed dte property
- [ ] Protocol documented with docstrings explaining each field's semantics
- [ ] Unit test: Position model instance passes isinstance(obj, MonitoredInstrument)
- [ ] Unit test: Prediction model instance passes isinstance(obj, MonitoredInstrument)
- [ ] entry_price resolves to entry_premium for options (unified aliasing)

## Technical Notes
- PIPE-058: MonitoredInstrument interface for both positions and predictions
- Structural subtyping: models satisfy protocol by having matching attributes, not by inheriting
- The protocol provides price data; threshold logic stays in exit functions
- Exit functions access stop/take-profit thresholds from system_config independently
- This protocol is shared across epics: epic-005 (Position), epic-006 (exit eval), epic-009 (Prediction)
- Architect caveat: cross-epic coordination needed for protocol compliance

## Dependencies
- Depends on: none (protocol definition is foundational)
- Blocks: task-006-019-01 (prediction monitoring uses protocol)
