---
id: task-001-001-01
story: story-001-001
epic: epic-001
title: Create core entity tables (system_config, authors, reddit_posts, signals, portfolios, positions)
complexity: 2
---

# Task: Create core entity tables (system_config, authors, reddit_posts, signals, portfolios, positions)

## Description
Write the first section of `schema.sql` containing PRAGMA statements and CREATE TABLE IF NOT EXISTS for the 6 core entity tables: system_config, authors, reddit_posts, signals, portfolios, and positions. Include all column definitions, types, constraints, defaults, and the UNIQUE constraint on signals (ticker, signal_type, signal_date). The positions table has 28+ columns spanning stock-specific, option-specific, monitoring, and closure fields.

## Acceptance Criteria
- [ ] File `schema.sql` starts with `PRAGMA foreign_keys = ON;` and `PRAGMA journal_mode = WAL;`
- [ ] system_config table has key (VARCHAR(50) PRIMARY KEY), value (TEXT), updated_at (TIMESTAMP)
- [ ] authors table has all 10 columns with username UNIQUE constraint
- [ ] reddit_posts table has all 9 columns with reddit_id UNIQUE constraint
- [ ] signals table has all 15 columns with UNIQUE(ticker, signal_type, signal_date), is_emergence nullable, position_opened BOOLEAN
- [ ] portfolios table has all 8 columns including created_at TIMESTAMP
- [ ] positions table has all 28+ columns with correct nullability (option fields nullable for stocks, stock fields nullable for options), FK references to portfolios(id) and signals(id)
- [ ] All tables use CREATE TABLE IF NOT EXISTS for idempotent execution

## Technical Notes
- PRD Appendix B lines 1814-2007 define all column specs
- positions.direction and option_type are intentionally redundant per PRD note
- positions has stock-specific (shares, shares_remaining), monitoring (stop_loss_price, peak_price, trailing_stop_active, time_extension), option-specific (option_type through underlying_price_at_entry), and closure fields (exit_date through realized_return_pct)
- Use SQLite-compatible types (VARCHAR, INT, FLOAT, TEXT, BOOLEAN, DATE, TIMESTAMP)

## Files to Create/Modify
- `schema.sql` (new file, first section)
