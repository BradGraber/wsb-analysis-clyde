---
id: task-008-005-01
story: story-008-005
title: Implement confidence sparkline with batch fetching and adaptive rendering
complexity: 2
---

# Task: Implement confidence sparkline with batch fetching and adaptive rendering

## Description
Build the confidence sparkline component using the library recommended by the sparkline spike (task-008-004-01). On tab mount, batch-fetch confidence history via GET /signals/history?signal_type=X&days=14, distribute results to individual signal cards by ticker. Implement adaptive rendering: <=2 data points show as scatter dots, 3+ points show as a line. Show a loading placeholder while data is being fetched. Cache results in-memory per portfolio tab.

## Acceptance Criteria
- [ ] Confidence sparkline renders at ~100px x 30px within each signal card
- [ ] Data fetched via batch GET /signals/history on tab mount, distributed by ticker
- [ ] Adaptive rendering: <=2 points -> scatter dots, 3+ points -> line
- [ ] Loading placeholder displayed while fetch is in progress
- [ ] Data cached in-memory per portfolio tab (no re-fetch on tab switch)

## Technical Notes
- Uses library/approach from sparkline spike (task-008-004-01)
- Batch fetch pattern: single API call returns history for all signals in the portfolio
- Cache: extend useSignals composable or create a dedicated sparkline cache Map
- Placeholder: gray dashed line or shimmer effect at sparkline dimensions
- FR-008: 7-14 day sparkline window for signal confidence history

## Dependencies
- Depends on: task-008-003-01 (signal cards provide mounting point), task-008-004-01 (spike determines library)
- Blocks: none
