---
id: task-009-006-02
story: story-009-006
title: Implement evaluation period rollover (create next active period after completion)
complexity: 1
---

# Task: Implement evaluation period rollover (create next active period after completion)

## Description
After completing all 4 evaluation periods (task-009-006-01), immediately create the next 4 active periods with period_start = previous period_end (no gaps in evaluation coverage) and period_end = new period_start + 30 days. Each new period records value_at_period_start from the portfolio's current value at rollover time. The completion + rollover should be atomic (single transaction). PRD Section 3.2.2 lines 387-389.

## Acceptance Criteria
- [ ] After 4 periods are completed, 4 new active periods are created in the same transaction
- [ ] New period_start = previous period_end (no gaps)
- [ ] New period_end = new period_start + 30 days
- [ ] New value_at_period_start = portfolio's current_value at rollover time
- [ ] New status = 'active' for all 4
- [ ] Completion + rollover is atomic (single transaction with both UPDATEs and INSERTs)
- [ ] Reuses the same 4-portfolio creation logic from task-009-005-01 (with parameterized start date)

## Technical Notes
- This is structurally identical to task-009-005-01 but with a different start date (previous period_end instead of today)
- Should be implemented as a call to the same creation function with a date parameter
- Transaction boundary: BEGIN; UPDATE x4 (complete); INSERT x4 (new); COMMIT;
- The no-gaps guarantee ensures continuous evaluation coverage

## Dependencies
- Depends on: task-009-006-01 (period completion triggers rollover)
- Blocks: none
