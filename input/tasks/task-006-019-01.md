---
id: task-006-019-01
story: story-006-019
title: Implement prediction loading and Schwab cache reuse in monitoring loop
complexity: 2
---

# Task: Implement prediction loading and Schwab cache reuse in monitoring loop

## Description
Extend the Phase 6 monitoring loop to load 'tracking' predictions after all real positions have been processed. Predictions reuse the per-run ticker cache populated during real position monitoring (story-006-001). For tickers not in the cache (prediction-only tickers), batch new Schwab API calls. Real positions always have priority for Schwab API access. Update each prediction's current_premium from cached or freshly-fetched data.

## Acceptance Criteria
- [ ] Predictions with status='tracking' loaded after all real positions processed
- [ ] Real positions have priority; predictions process second
- [ ] Predictions reuse cached Schwab data (no duplicate calls for shared tickers)
- [ ] Prediction-only tickers (not in cache) get new batched Schwab calls
- [ ] current_premium updated for each tracking prediction from cache or fresh data
- [ ] Predictions do NOT update portfolio cash_available

## Technical Notes
- PIPE-058: Predictions processed alongside positions using MonitoredInstrument
- Cache populated by task-006-001-02 during real position monitoring
- Batching uncached tickers reduces Schwab API call count
- The prediction processing order: load -> fetch prices -> run exit cascade -> record results

## Dependencies
- Depends on: task-006-015-01 (MonitoredInstrument protocol), task-006-001-02 (ticker cache)
- Blocks: task-006-019-02
