---
id: task-006-016-02
story: story-006-016
title: Write breakeven, time extension, and priority unit tests (Tests 5-9)
complexity: 3
---

# Task: Write breakeven, time extension, and priority unit tests (Tests 5-9)

## Description
Write 5 unit tests covering stock breakeven and time extension conditions plus priority ordering: (5) breakeven promotion at +5% gain AND Day 5 with 'breakeven_stop' exit, (6) base time stop at Day 5 when gain < +5%, (7) extended time stop at Day 7 when gain +5-15% at Day 5, (8) trailing time stop at Day 10 after partial take-profit, (9) candle iteration priority where both stop-loss and take-profit breach in same candle resolves to stop-loss. Use hand-written fixtures.

## Acceptance Criteria
- [ ] Test 5: Breakeven promotion at +5%/Day 5, exit fires as 'breakeven_stop'
- [ ] Test 6: Base time stop triggers at Day 5 when gain < +5%
- [ ] Test 7: Extended time stop triggers at Day 7 when gain was +5-15% at Day 5
- [ ] Test 8: Trailing time stop triggers at Day 10 after partial take-profit occurred
- [ ] Test 9: Same-candle dual breach resolves to stop-loss (higher priority per PIPE-044)
- [ ] All tests use pytest with mock positions, mock candle sequences

## Technical Notes
- Test 9 validates PIPE-044 priority ordering within candle iteration logic
- Time extension tests need mock positions with varying gain levels and hold_days
- Breakeven test must verify stop_loss_price was updated to entry_price
- Use calendar day calculations for hold_days

## Dependencies
- Depends on: task-006-004-01, task-006-004-02, task-006-008-01
- Blocks: none
