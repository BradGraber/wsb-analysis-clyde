---
id: task-005-001-01
story: story-005-001
title: Implement market hours gate function with ET timezone handling
complexity: 2
---

# Task: Implement market hours gate function with ET timezone handling

## Description
Create a function `is_market_open() -> bool` that checks whether the current time is within US equity market hours (9:30 AM - 4:00 PM Eastern Time) on a weekday. Uses pytz for proper EST/EDT handling. Returns False (with structured log warning including current ET time) when outside hours or on weekends. This is the Phase 5 pipeline entry gate -- if False, position management skips all opens and returns early.

## Acceptance Criteria
- [ ] Function uses `pytz.timezone('US/Eastern')` for DST-correct ET evaluation
- [ ] Returns True only when current ET time is between 9:30 AM and 4:00 PM on weekdays (Mon-Fri)
- [ ] Returns False for Saturday and Sunday regardless of time
- [ ] Logs warning with current ET time when returning False: "Signal detected outside market hours; position not opened. Re-run during market hours to act on signals."
- [ ] Function is pure (accepts optional `now` parameter for testability)
- [ ] Includes placeholder comment for future US market holiday checking
- [ ] Unit tests cover: weekday during hours, weekday before open, weekday after close, weekend, DST transition boundary

## Technical Notes
- PIPE-031 requirement
- Keep this as a standalone utility function in the position management module
- The `now` parameter enables deterministic testing without mocking datetime
- DST transition: EST (UTC-5) switches to EDT (UTC-4) in spring; pytz handles this
- This function is called once per pipeline run, not per signal

## Dependencies
- Depends on: none (utility function, no DB or API dependencies)
- Blocks: task-005-002-01
