---
id: task-003-005-02
story: story-003-005
title: Implement ticker normalization and exclusion filtering
complexity: 2
---

# Task: Implement ticker normalization and exclusion filtering

## Description
Implement ticker post-processing logic that normalizes AI-extracted tickers to uppercase, resolves common company names to ticker symbols using a static lookup dictionary, filters out non-ticker words, and deduplicates tickers within a single response. This is applied as a post-processing step after JSON parsing (task-003-005-01).

## Acceptance Criteria
- [ ] All ticker symbols normalized to uppercase (e.g., "nvda" -> "NVDA")
- [ ] Common company name resolution via static dict: "the mouse" -> "DIS", "Zuck"/"Zuckerberg" -> "META", "apple" -> "AAPL" (configurable dict)
- [ ] Non-ticker exclusion list filters: "I", "A", "CEO", "DD", "YOLO" (unless in clear ticker context -- defer context detection to AI)
- [ ] Crypto tickers included: BTC, ETH recognized as valid
- [ ] Deduplication: if "NVDA" appears twice in tickers array, reduced to one entry
- [ ] ticker_sentiments array is also filtered/deduped to match the cleaned tickers list
- [ ] Exclusion list is a configurable set (module-level constant for easy tuning)
- [ ] `normalize_tickers(tickers, ticker_sentiments)` returns cleaned (tickers, ticker_sentiments) tuple
- [ ] Unit test: uppercase normalization
- [ ] Unit test: company name resolution
- [ ] Unit test: exclusion filtering
- [ ] Unit test: deduplication

## Technical Notes
- Company name resolution dict can start small (5-10 entries) and grow over time
- The exclusion list is a pragmatic filter; the AI prompt (E.7) instructs the model to avoid these, but we double-check
- PRD reference: Appendix E.7 (ticker extraction rules)

## Dependencies
- Depends on: task-003-005-01 (parsed AI response with raw tickers)
- Blocks: task-003-009-01
