---
id: task-006-006-02
story: story-006-006
title: Implement options premium take-profit and trailing stop exits
complexity: 3
---

# Task: Implement options premium take-profit and trailing stop exits

## Description
Implement two related options exit conditions: premium take-profit at +100% gain (exit 50% contracts, activate trailing stop) and premium trailing stop at -30% from peak_premium (exit remaining contracts after partial take-profit). Take-profit triggers when current_premium >= entry_premium * 2.0 and exits 50% of contracts_remaining, setting trailing_stop_active=TRUE. Trailing stop triggers when current_premium <= peak_premium * 0.70, exiting all remaining contracts.

## Acceptance Criteria
- [ ] Take-profit triggers when current_premium >= entry_premium * 2.0 (+100% gain)
- [ ] Take-profit exits 50% of contracts_remaining (floor rounding)
- [ ] After take-profit, trailing_stop_active is set to TRUE
- [ ] Trailing stop triggers when current_premium <= peak_premium * 0.70 (-30% from peak)
- [ ] Trailing stop exits all remaining contracts (100% of contracts_remaining)
- [ ] Exit reasons: 'take_profit' for partial, 'trailing_stop' for trailing
- [ ] Trailing stop only evaluates when trailing_stop_active is TRUE
- [ ] Priority: take-profit before trailing in cascade (PIPE-045)
- [ ] Functions accept MonitoredInstrument (not concrete Position type)

## Technical Notes
- FR-042: Premium take-profit at +100%, exit 50%, apply trailing stop
- FR-043: Trailing stop at peak_premium * 0.70 (-30% from peak)
- PIPE-045: Priority after stop-loss: take-profit > trailing > time
- Partial exit mechanics delegated to story-006-009
- Peak premium tracking delegated to story-006-010
- These two conditions are tightly coupled (trailing activates after take-profit)

## Dependencies
- Depends on: task-006-005-01 (expiration/cascade framework), task-006-009-01 (partial exit), task-006-010-01 (peak tracking)
- Blocks: none
