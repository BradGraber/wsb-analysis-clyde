---
id: task-002-002-01
story: story-002-002
title: Implement image URL detection for three domain patterns
complexity: 1
---

# Task: Implement image URL detection for three domain patterns

## Description
Add a `detect_image_url(submission) -> Optional[str]` function to `src/reddit.py` that inspects an Async PRAW Submission's `url` attribute and returns the URL if it matches any of three image hosting patterns (i.redd.it, imgur, preview.redd.it), or None otherwise. This determines whether the post's image should be sent to the vision API.

## Acceptance Criteria
- [ ] Returns the URL string when submission.url contains "i.redd.it" (e.g., https://i.redd.it/abc123.jpg)
- [ ] Returns the URL string when submission.url contains "imgur" (e.g., https://i.imgur.com/abc123.png, https://imgur.com/abc123)
- [ ] Returns the URL string when submission.url contains "preview.redd.it" (e.g., https://preview.redd.it/abc123.jpg?...)
- [ ] Returns None for non-image URLs (e.g., youtube.com, reddit.com/r/..., self posts with no URL)
- [ ] Unit tests cover all three positive patterns and at least 2 negative patterns using pytest parametrize

## Technical Notes
- Simple substring matching is sufficient (no regex needed); the PRD specifies these three domains
- Self-posts have `url` pointing to the post itself (reddit.com/r/...); these should return None
- The function takes an Async PRAW Submission object (or just the URL string for testability)
- PRD reference: PIPE-003

## Dependencies
- Depends on: none (pure function, no external deps)
- Blocks: task-002-002-02
