---
id: task-008-007-01
story: story-008-007
title: Build position list with 3 primary states, exit badges, and market hours overlay
complexity: 2
---

# Task: Build position list with 3 primary states, exit badges, and market hours overlay

## Description
Build the `<PositionList>` component for the Positions sub-tab. Display positions for the active portfolio via GET /positions?portfolio_id=X. Implement 3 primary states: Active/Monitoring (standard display), Near Exit (amber when nearest_exit_distance_pct <= 2.0), Partially Closed (shows remaining/total). Add Market Closed overlay (greyed + "as of [timestamp]"). Map 8 canonical exit_reason values to human-readable badge labels with color coding.

## Acceptance Criteria
- [ ] Positions sub-tab displays positions from GET /positions?portfolio_id=X
- [ ] "Active/Monitoring": shows current_price, unrealized_return_pct, hold_days
- [ ] "Near Exit": amber styling when nearest_exit_distance_pct <= 2.0
- [ ] "Partially Closed": shows shares_remaining/shares_total or contracts_remaining/contracts_total
- [ ] Market Closed overlay: greyed positions with "as of [last_close_timestamp]" when market is closed
- [ ] 8 exit_reason values mapped to labels: stop_loss->"Stop Loss", take_profit->"Take Profit", trailing_stop->"Trailing Stop", breakeven_stop->"Breakeven Stop", time_stop->"Time Stop", expiration->"Expiration", manual_close->"Manual Close", replaced->"Replaced"
- [ ] Exit badges with colors: stop_loss=red, take_profit=green, trailing_stop=blue, breakeven_stop=teal, time_stop=orange, expiration=yellow, manual_close=gray, replaced=purple

## Technical Notes
- Market hours: client-side US ET check (Mon-Fri 9:30 AM - 4:00 PM ET); basic weekday check, no holiday calendar
- Near Exit: use nearest_exit_distance_pct convenience field from API response
- Convenience fields (hold_days, unrealized_return_pct) come pre-computed from the API
- Badge component: reusable `<ExitReasonBadge :reason="exit_reason" />`
- Position card: `<PositionCard :position="position" />` with conditional stock/options layout

## Dependencies
- Depends on: task-008-002-01 (Positions sub-tab), task-008-002-02 (usePositions composable)
- Blocks: task-008-007-02, task-008-008-01, task-008-012-01
