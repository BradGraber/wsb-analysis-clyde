---
id: task-008-002-02
story: story-008-002
title: Scaffold shared composables with stub implementations
complexity: 2
---

# Task: Scaffold shared composables with stub implementations

## Description
Create the 4 shared Vue composables that provide cross-view data fetching and caching: `useSignals()`, `usePositions()`, `usePortfolios()`, `useAnalysis()`. Each returns reactive data refs (`data`, `loading`, `error`) and async fetch functions. Implement in-memory caching per portfolio tab so tab switching does not re-fetch. Use the API client from task-008-001-02.

## Acceptance Criteria
- [ ] `useSignals(portfolioId)` returns `{ signals, loading, error, fetchSignals }` with reactive refs
- [ ] `usePositions(portfolioId)` returns `{ positions, loading, error, fetchPositions }` with reactive refs
- [ ] `usePortfolios()` returns `{ portfolios, loading, error, fetchPortfolios }` with reactive refs
- [ ] `useAnalysis()` returns `{ status, runResult, loading, error, fetchStatus }` with reactive refs
- [ ] Each composable caches fetched data in-memory per portfolio_id; cleared only on page reload
- [ ] Fetch functions call the appropriate API endpoints via the shared API client
- [ ] Loading and error states are correctly managed (loading=true during fetch, error set on failure)

## Technical Notes
- Composables use Vue 3 `ref()` and `reactive()` for state management
- Cache: internal `Map<portfolioId, data>` within each composable, or a module-level cache
- API endpoints: GET /signals?portfolio_id=X, GET /positions?portfolio_id=X, GET /evaluation-periods?portfolio_id=X, GET /status
- Each composable should accept portfolio_id as parameter and be callable from any component
- No Vuex/Pinia -- these composables ARE the state management layer (UI-NO-STATE)

## Dependencies
- Depends on: task-008-001-02 (API client module)
- Blocks: task-008-003-01 (useSignals drives signal card rendering), task-008-007-01 (usePositions drives position list)
